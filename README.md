# retail_network

Для запуска проекта:

1. Скачайте или клонируйте проект
2. Установите виртуальное окружение
3. Установите зависимости из файла requirements.txt
4. Переименуйте файл .env.sample в .env
5. Заполните файл .env данными для подключения к вашей базе данных и впишите секретный ключ
6. Создайте и примените миграции
7. Создайте суперпользователя
8. Запустите сервер
9. Для доступа к api необходимо получить Bearer-токен отправив POST запрос на эндпоинт /token/ с корректными данными "username" и "password"
10. Включите токен доступа в заголовок запроса: Authorization: Bearer <access_token>


NetworkUnit является основной моделью, позволяющей создавать единицы сети.
Есть три типа единиц: factory, retail, businessman
Иерархия реализована так: 
- если, при создании объекта, вы указываете тип - factory, 
то значение уровня 'level' автоматически устанавливается 0 и значение поля supplier None.
- если вы выбираете тип retail или businessman и в качестве поставщика 'supplier' выбираете объект с типом factory, 
то значение level устанавливается 1.
- если в качестве поставщика вы выбираете объект с типом retail или businessman,
то значение level устанавливается 2.

В админ панели, на странице всех объектов модели NetworkUnit:
- в поле action добавлена функция очищения задолженности.
- фильтр по названию города.
- в списке добавлен столбец "Ссылка на поставщика", в котором отображается название поставщика у каждого объекта, 
нажав на которе можно попасть на страницу редактирования данного поставщика

API интерфейс реализован следующим образом:
- Средствами DRF реализованы представления для создания/просмотра/редактирования/удаления объектов модели NetworkUnit.
- В файле urls.py описаны все эндпоинты для API запросов.
- При попытке обновить поле задолженности "debt" или указать это поле при создании объекта будет возникать ошибка.
- Поле debt можно задавать или редактировать только через админ-панель.
- Реализованы вложенные операторы для моделей Contact и Product, 
для того что бы при выводе объекта модели NetworkUnit отображались все поля связанных моделей
- Для фильтрации по определенной стране необходимо отправить GET запрос по адресу /networkunits/?search=Россия
- Создание пользователей осуществляется только через админ-панель, где и меняется статус Активен/Неактивен
- Доступ к API осуществляется по Bearer токену только для активных пользователей.